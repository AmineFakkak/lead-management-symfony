{# templates/admin/menu.html.twig #}
{% extends '@EasyAdmin/menu.html.twig' %}

{% block menu %}
    <!-- Custom Logo/Brand Section -->
    <div class="sidebar-brand p-3 mb-3" style="background: rgba(0,0,0,0.1);">
        <a href="{{ path('admin') }}" class="text-white text-decoration-none d-flex align-items-center">
            <div class="brand-image bg-white rounded-circle p-2 me-2" style="width: 40px; height: 40px;">
                <i class="fa fa-bolt text-primary"></i>
            </div>
            <span class="brand-text fw-bold">Flash Ing√©nierie</span>
        </a>
    </div>

    <!-- Custom Welcome/User Info -->
    <div class="user-panel px-3 pb-3 mb-3 d-flex align-items-center" style="border-bottom: 1px solid rgba(255,255,255,0.1);">
        <div class="image">
            <div class="bg-white rounded-circle p-2" style="width: 40px; height: 40px;">
                <i class="fa fa-user-circle text-primary"></i>
            </div>
        </div>
        <div class="info ms-2">
            <span class="text-white">{{ app.user.email|default('Welcome!') }}</span>
        </div>
    </div>

    <!-- Search Box -->
    <div class="sidebar-search px-3 mb-4">
        <div class="input-group">
            <input type="text" class="form-control form-control-sm bg-dark text-white border-0" placeholder="Search..." style="opacity: 0.7;">
            <button class="btn btn-sm btn-dark" type="button">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>

    <!-- Custom Menu Items -->
    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu">
        {% for item in ea.mainMenu().items %}
            {{ _self.render_menu_item(item) }}
        {% endfor %}
    </ul>

    <!-- Custom Footer Section -->
    <div class="sidebar-footer mt-auto p-3" style="border-top: 1px solid rgba(255,255,255,0.1);">
        <div class="text-center small">
            <a href="#" class="text-white-50 text-decoration-none me-2">Settings</a> 
            <span class="text-white-50">|</span>
            <a href="{{ path('app_logout') }}" class="text-white-50 text-decoration-none ms-2">Logout</a>
        </div>
    </div>
{% endblock %}

{% macro render_menu_item(item) %}
    {% if item.isMenuSection and not item.isMenuSection.item.isMenuSection %}
        {# This is a section header #}
        <li class="nav-header">{{ item.label }}</li>
    {% elseif item.isMenuSection %}
        {# This is a menu item #}
        <li class="nav-item {% if item.isSelected %}active{% endif %} {% if item.items|length > 0 %}has-treeview{% endif %}">
            <a href="{{ item.link }}" class="nav-link {% if item.isSelected %}active{% endif %}">
                <i class="nav-icon {{ item.icon }}"></i>
                <p>
                    {{ item.label }}
                    {% if item.items|length > 0 %}
                        <i class="right fas fa-angle-left"></i>
                    {% endif %}
                </p>
            </a>
            {% if item.items|length > 0 %}
                <ul class="nav nav-treeview">
                    {% for subitem in item.items %}
                        <li class="nav-item">
                            <a href="{{ subitem.link }}" class="nav-link {% if subitem.isSelected %}active{% endif %}">
                                <i class="nav-icon {{ subitem.icon }}"></i>
                                <p>{{ subitem.label }}</p>
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </li>
    {% endif %}
{% endmacro %}